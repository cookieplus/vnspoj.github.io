---
layout: post
title:  "ZABAVA - ZABAVA"
categories: [dp, math]
code: ZABAVA
src: ZABAVA.cpp
codeforces: https://codeforces.com/group/FLVn1Sc504/contest/274863/problem/L
---


N sinh viên mới chuẩn bị được nhập vào kí túc xá của trường. Khu kí túc của trường gồm M phòng, mỗi phòng lúc đầu đều không có ai ở. Mỗi ngày có một sinh viên mới sẽ được chuyển vào một trong M phòng này. Khi một người mới đến, buổi tối hôm đó, cả phòng sẽ tổ chức một bữa tiệc để mừng thành viên mới, và họ tạo ra những tiếng ồn, có độ “ồn ào” bằng tổng số người có trong phòng. Trưởng khu kí túc xá không thích điều này, và ông quyết định vào buổi sáng sớm của, ngày ông sẽ đuổi hết sinh viên trong một phòng nào đó ra ngoài để tránh sự ồn ào gây ra phiền phức cho ông. Những sinh viên này khi đã bị đuổi thì sẽ ra ngoài kí túc ở và không bao giờ trở lại nữa. Tuy nhiên, trong N ngày, ông chỉ được phép làm việc này K lần. Hãy giúp ông đưa ra những quyết định đúng đắn, để tổng những tiếng “ồn” ông phải chịu là ít nhất có thể. 

#### Input

*   Dòng đầu 3 số N, M, K. (1 ≤ N ≤ 1.000.000, 1 ≤ M ≤ 100, 1 ≤ K ≤ 500)
*   N dòng sau, mỗi dòng là một số nguyên trong khoảng \[1, M\] chỉ phòng mà ngày thứ i sẽ có sinh viên mới vào.

#### Output

Số nguyên duy nhất là số lượng tiếng “ồn” nhỏ nhất có thể.

#### Example

```
Input

5 1 2
1
1
1
1
1

Output
7
```

<!--more-->



Nhận xét rằng thứ tự sinh viên chuyển vào các phòng theo từng ngày không ảnh huởng đến cách đuổi của ông chủ. Bởi vì ta có thể xử lý sinh viên từng phòng thành cụm các ngày liền nhau cho đến hết các sinh viên phòng đó, rồi mới xử lý cho sinh viên các phòng tiếp theo. Giả sử có 5 phòng thì ta có thể  xử lý các sinh viên phòng 1 trước trong những ngày đầu tiên, sau đó mới xử lý các sinh viên phòng 2, 3, 4 và 5.

Do đó, ta chỉ cần lưu lại `a[i]` là số lượng sinh viên sẽ ghé thăm phòng thứ `i`, với `1 <= i <= M <= 100`.

Gọi `F[i][j]` là độ ồn tối thiểu để đạt được đối với phòng `i` với `j` lần đuổi. Gọi `G[i][j]` là độ ổn tối thiểu để xử lý `i` phòng đầu tiên với `j` lần đuổi. Quy hoạch động đơn giản như sau:

`G[i][j] = G[i-1][j-c] + F[i][c]` với `2 <= i <= M`, `0 <= j <= K`, `0 <= c <= j`

với cở sở là `G[1][j] = F[1][j]`, `0 <= j <= K`.

Giờ cần tính `F[i][j]`. Đơn giản xét 11 thằng và sẽ thực hiện `i` lần đuổi, tức sẽ tạo ra `i+1` nhóm sinh viên sẽ bị đuổi, cụ thể xét bảng sau:

<div class="table-full-width" markdown="block">

Số lần đuổi | Số nhóm bị đuổi | Các nhóm tối ưu
